<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Flag - ä½ çš„ç›®æ ‡è¾¾æˆåŠ©æ‰‹</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap');
        :root { --safe-top: env(safe-area-inset-top, 20px); --safe-bottom: env(safe-area-inset-bottom, 20px); }
        body { font-family: 'Inter', -apple-system, sans-serif; background-color: #F8F9FB; color: #1D1D1F; overflow: hidden; margin: 0; }
        
        .login-bg { background: #FDF4F4; }
        .flag-gradient { background: linear-gradient(135deg, #FF4D4D 0%, #F53D3D 100%); }
        .glass-header { background: rgba(255, 255, 255, 0.9); backdrop-filter: saturate(180%) blur(20px); -webkit-backdrop-filter: saturate(180%) blur(20px); }
        
        /* å¹¿åœºå¡ç‰‡è¿˜åŸå›¾3 */
        .square-card {
            background: white;
            border-radius: 1.5rem;
            padding: 1.5rem;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 4px 20px rgba(0,0,0,0.02);
        }
        .square-tag {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            color: white;
            margin-right: 12px;
        }

        /* è¾“å…¥æ³•é¿è®©ï¼šç¡®ä¿å¼¹çª—ä½ç½®é ä¸Š */
        .input-modal-content {
            position: absolute;
            top: 15%; /* æ˜¾è‘—ä¸Šç§»ï¼Œé¿å¼€é”®ç›˜ */
            left: 5%;
            right: 5%;
            background: white;
            border-radius: 2.5rem;
            padding: 2rem;
            box-shadow: 0 30px 60px rgba(0,0,0,0.15);
        }

        /* è¿›åº¦æ•°å­—æ ·å¼ */
        .progress-num {
            font-size: 1.25rem;
            font-weight: 900;
            font-style: italic;
            color: #FF4D4D;
        }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s ease-out; }
        
        /* å¼•å¯¼å¯¹è¯æ°”æ³¡ */
        .ai-bubble {
            background: #F2F2F7;
            padding: 1rem;
            border-radius: 1.25rem;
            border-bottom-left-radius: 0.25rem;
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #3A3A3C;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            const [user, setUser] = useState(null);
            const [view, setView] = useState('login'); // login, home, discover
            const [isCreating, setIsCreating] = useState(false);

            if (view === 'login') return <LoginScreen onLogin={() => setView('home')} />;
            return <MainContainer view={view} setView={setView} isCreating={isCreating} setIsCreating={setIsCreating} />;
        }

        function LoginScreen({ onLogin }) {
            return (
                <div className="h-screen w-screen login-bg flex flex-col items-center justify-center px-6">
                    <div className="w-20 h-20 flag-gradient rounded-[2.2rem] shadow-xl flex items-center justify-center text-white text-4xl font-black italic mb-10 transform -rotate-6">F</div>
                    <div className="w-full max-w-sm bg-white rounded-[3rem] p-10 shadow-2xl">
                        <div className="text-center mb-10">
                            <h1 className="text-3xl font-black text-[#1D1D1F] mb-2">æ¬¢è¿å›æ¥</h1>
                            <p className="text-slate-400 font-bold text-sm">ç«‹ä¸ª FLAGï¼Œä¸‡ä¸€å®ç°äº†å‘¢</p>
                        </div>
                        <div className="space-y-4">
                            <input type="text" placeholder="é‚®ç®±/æ‰‹æœºå·" className="w-full bg-[#F7F8FA] border-none rounded-2xl p-5 font-bold outline-none" />
                            <input type="password" placeholder="å¯†ç " className="w-full bg-[#F7F8FA] border-none rounded-2xl p-5 font-bold outline-none" />
                            <button onClick={onLogin} className="w-full py-5 flag-gradient text-white rounded-[1.5rem] font-black shadow-lg">ç™»å½•</button>
                        </div>
                        <div className="flex items-center my-8"><div className="flex-grow h-[1px] bg-slate-100"></div><span className="mx-4 text-[10px] font-black text-slate-300">æˆ–è€…</span><div className="flex-grow h-[1px] bg-slate-100"></div></div>
                        <div className="flex gap-4">
                            <button onClick={onLogin} className="flex-1 bg-[#F7F8FA] py-3 rounded-2xl font-bold text-sm flex items-center justify-center gap-2">å¾®ä¿¡</button>
                            <button onClick={onLogin} className="flex-1 bg-[#F7F8FA] py-3 rounded-2xl font-bold text-sm flex items-center justify-center gap-2">Google</button>
                        </div>
                    </div>
                </div>
            );
        }

        function MainContainer({ view, setView, isCreating, setIsCreating }) {
            const [myFlags, setMyFlags] = useState([
                { id: 1, title: 'å­¦ä¹ æ³•å¼çƒ¹é¥ª', progress: 90, sub: 'å°å¨å¨˜', icon: 'ğŸ³', color: '#FF9500' },
                { id: 2, title: 'å¤‡æˆ˜é›…æ€è€ƒè¯• 8.0', progress: 45, sub: 'ALEX_W', icon: 'ğŸ“š', color: '#007AFF' }
            ]);

            const publicFlags = [
                { id: 101, title: 'æŒ‘æˆ˜30å¤©ä¸å–å¥¶èŒ¶', progress: 85, sub: 'å¥¶èŒ¶æ·±åº¦æ‚£è€…', icon: 'ğŸ¥¤', color: '#FF3B30' },
                { id: 102, title: 'å¤‡æˆ˜é›…æ€è€ƒè¯• 8.0', progress: 45, sub: 'ALEX_W', icon: 'ğŸ“š', color: '#007AFF' },
                { id: 103, title: 'æ‰“é€ ä¸€ä¸ªå¼€æº UI åº“', progress: 12, sub: 'æå®¢å¼ ', icon: 'ğŸ’»', color: '#5856D6' },
                { id: 104, title: 'å­¦ä¹ æ³•å¼çƒ¹é¥ª', progress: 90, sub: 'å°å¨å¨˜', icon: 'ğŸ³', color: '#FF9500' }
            ];

            return (
                <div className="h-screen w-screen flex flex-col overflow-hidden bg-[#F8F9FB]">
                    <header className="shrink-0 glass-header px-6 pb-4 pt-[var(--safe-top)] flex justify-between items-end h-24">
                        <h1 className="text-2xl font-black tracking-tighter uppercase">{view === 'home' ? 'My Flags' : 'Square'}</h1>
                        <div className="text-[10px] font-black text-slate-200 uppercase tracking-widest mb-1">Status: Active</div>
                    </header>

                    <main className="flex-grow overflow-y-auto no-scrollbar px-5 py-4 pb-32">
                        {view === 'home' ? (
                            <div className="space-y-4">
                                {myFlags.map(f => (
                                    <div key={f.id} className="square-card">
                                        <div className="flex items-center">
                                            <div className="square-tag" style={{backgroundColor: f.color}}>{f.icon}</div>
                                            <div>
                                                <div className="font-black text-slate-800 text-sm">{f.title}</div>
                                                <div className="text-[10px] font-bold text-slate-300 uppercase tracking-tight">{f.sub}</div>
                                            </div>
                                        </div>
                                        <div className="progress-num">{f.progress}%</div>
                                    </div>
                                ))}
                            </div>
                        ) : (
                            <div className="space-y-3">
                                {publicFlags.map(f => (
                                    <div key={f.id} className="square-card">
                                        <div className="flex items-center">
                                            <div className="square-tag" style={{backgroundColor: f.color}}>{f.icon}</div>
                                            <div>
                                                <div className="font-black text-slate-800 text-sm">{f.title}</div>
                                                <div className="text-[10px] font-bold text-slate-300 uppercase tracking-tight">{f.sub}</div>
                                            </div>
                                        </div>
                                        <div className="progress-num">{f.progress}%</div>
                                    </div>
                                ))}
                            </div>
                        )}
                    </main>

                    {/* åº•éƒ¨å¯¼èˆª */}
                    <nav className="shrink-0 bg-white border-t border-slate-100 px-12 pb-[calc(var(--safe-bottom)+1rem)] pt-4 flex justify-between items-center z-30">
                        <button onClick={() => setView('home')} className={`flex flex-col items-center gap-1 ${view === 'home' ? 'text-red-500' : 'text-slate-300'}`}>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z"/><line x1="4" x2="4" y1="22" y2="15"/></svg>
                            <span className="text-[9px] font-black uppercase">Flags</span>
                        </button>
                        <button onClick={() => setIsCreating(true)} className="w-14 h-14 -mt-12 flag-gradient rounded-2xl shadow-xl shadow-red-100 flex items-center justify-center text-white text-3xl font-light border-4 border-white transform rotate-45 active:scale-90 transition-all">
                            <span className="-rotate-45">+</span>
                        </button>
                        <button onClick={() => setView('discover')} className={`flex flex-col items-center gap-1 ${view === 'discover' ? 'text-red-500' : 'text-slate-300'}`}>
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                            <span className="text-[9px] font-black uppercase">Square</span>
                        </button>
                    </nav>

                    {/* AI æ‹†è§£æ¨¡æ€æ¡† - ä¿®æ”¹ä¸ºä¸Šç§»é¿è®©é”®ç›˜ */}
                    {isCreating && <AICreationModal onClose={() => setIsCreating(false)} onAdd={(f) => setMyFlags([f, ...myFlags])} />}
                </div>
            );
        }

        function AICreationModal({ onClose, onAdd }) {
            const [step, setStep] = useState(1); // 1: è¾“å…¥, 2: ç»†åŒ–è¯¢é—®, 3: ç”Ÿæˆç»“æœ
            const [inputText, setInputText] = useState('');
            const [aiMessage, setAiMessage] = useState('ä¸‹ä¸€ä¸ªæŒ‘æˆ˜æ˜¯ï¼Ÿ');
            const [loading, setLoading] = useState(false);

            const handleProcess = async () => {
                setLoading(true);
                // æ¨¡æ‹Ÿ AI å¼•å¯¼é€»è¾‘
                await new Promise(r => setTimeout(r, 1200));
                
                if (step === 1) {
                    setAiMessage(`â€œ${inputText}â€æ˜¯ä¸ªå¾ˆæ£’çš„ç›®æ ‡ï¼ä¸ºäº†æ›´ç²¾å‡†ï¼Œä½ æ‰“ç®—æ¯å¤©æŠ•å…¥å¤šå°‘æ—¶é—´ï¼Œæˆ–è€…ç¬¬ä¸€å‘¨çš„ç›®æ ‡æ˜¯ä»€ä¹ˆï¼Ÿ`);
                    setStep(2);
                } else if (step === 2) {
                    setAiMessage("æ˜ç™½äº†ï¼æ­£åœ¨ä¸ºä½ ç”Ÿæˆé‡åŒ–çš„æ‰§è¡Œæ¸…å•...");
                    await new Promise(r => setTimeout(r, 1500));
                    onAdd({
                        id: Date.now(),
                        title: inputText,
                        progress: 0,
                        sub: 'åˆšåˆšå¼€å¯',
                        icon: 'ğŸ¯',
                        color: '#34C759'
                    });
                    onClose();
                }
                setLoading(false);
            };

            return (
                <div className="fixed inset-0 z-[100]">
                    <div className="absolute inset-0 bg-slate-900/40 backdrop-blur-md" onClick={onClose} />
                    <div className="input-modal-content animate-slide-up">
                        <div className="ai-bubble">
                            {aiMessage}
                        </div>
                        
                        <div className="space-y-6">
                            <textarea 
                                autoFocus
                                value={inputText}
                                onChange={(e) => setInputText(e.target.value)}
                                placeholder={step === 1 ? "ä¸‰ä¸ªæœˆå­¦ä¼šæ¸¸æ³³" : "æ¯”å¦‚ï¼šæ¯å¤©ç»ƒä¹  1 å°æ—¶"}
                                className="w-full text-xl font-black border-none focus:ring-0 placeholder:text-slate-200 resize-none h-24 bg-transparent p-0"
                            />
                            
                            <button 
                                onClick={handleProcess}
                                disabled={loading || !inputText}
                                className="w-full py-5 rounded-[1.5rem] bg-black text-white font-black uppercase flex justify-center items-center h-[64px] active:scale-95 transition-all shadow-xl"
                            >
                                {loading ? <div className="w-5 h-5 border-2 border-white/20 border-t-white rounded-full animate-spin"></div> : (step === 1 ? "å¼€å§‹æ‹†è§£" : "ç¡®è®¤ç»†èŠ‚")}
                            </button>
                        </div>

                        {/* é¢å¤–å…³é—­æŒ‰é’® */}
                        <button onClick={onClose} className="absolute -top-4 -right-4 w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg border border-slate-100">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#CCC" strokeWidth="3"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                        </button>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
